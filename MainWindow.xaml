<Window x:Class="costbenefi.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Sistema Costo-Beneficio" Height="750" Width="1600"
        WindowStartupLocation="CenterScreen" WindowState="Maximized"
        Background="#F5F7FA">

    <Window.Resources>
        <!-- Estilos para botones compactos -->
        <Style x:Key="CompactButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="32"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
        </Style>

        <!-- Estilo para TextBlocks del header -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <!-- Estilo para TabItem -->
        <Style x:Key="TabItemStyle" TargetType="TabItem">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="0,0,2,0"/>
            <Setter Property="Background" Value="#4a5568"/>
            <Setter Property="BorderBrush" Value="#2d3748"/>
            <Setter Property="BorderThickness" Value="1,1,1,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border" 
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8,8,0,0"
                                Margin="{TemplateBinding Margin}">
                            <ContentPresenter x:Name="ContentSite"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Center"
                                            ContentSource="Header"
                                            Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#2a5298"/>
                                <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                                <Setter Property="Panel.ZIndex" Value="1"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#3182ce"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Estilo para botones POS -->
        <Style x:Key="POSButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{TemplateBinding BorderBrush}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.98" ScaleY="0.98"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Estilo para productos en lista POS -->
        <Style x:Key="ProductoListBoxItemStyle" TargetType="ListBoxItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border x:Name="border" 
                                Background="White" 
                                Margin="2" 
                                CornerRadius="5"
                                BorderThickness="1"
                                BorderBrush="#E5E7EB">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Text="{Binding NombreArticulo}" 
                                          FontWeight="Bold" FontSize="13" Foreground="#111827"/>
                                <TextBlock Grid.Row="1" FontSize="11" Foreground="#6B7280" Margin="0,2,0,0">
                                    <Run Text="Stock: "/><Run Text="{Binding StockTotal, StringFormat=F2, Mode=OneWay}"/><Run Text=" "/><Run Text="{Binding UnidadMedida}"/>
                                </TextBlock>
                                <TextBlock Grid.Row="2" Text="{Binding PrecioVentaFinal, StringFormat=C2, Mode=OneWay}" 
                                          FontWeight="Bold" FontSize="12" Foreground="#059669" Margin="0,2,0,0"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F3F4F6"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#3B82F6"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#EBF8FF"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#3B82F6"/>
                                <Setter TargetName="border" Property="BorderThickness" Value="2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <!-- TabControl principal que ocupa toda la ventana -->
        <TabControl x:Name="MainTabControl" 
                    Background="#F5F7FA" 
                    BorderThickness="0"
                    SelectionChanged="TabControl_SelectionChanged">

            <!-- Pestaña 1: Materia Prima (Inventario) -->
            <TabItem Header="📦 Materia Prima" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="45"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="35"/>
                    </Grid.RowDefinitions>

                    <!-- Header con información -->
                    <Border Grid.Row="0" Background="#2a5298" Padding="20,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="📦 Gestión de Materia Prima" 
                                       FontSize="18" Style="{StaticResource HeaderTextStyle}"/>

                            <TextBlock Grid.Column="1" x:Name="TxtContadorHeader" Text="0 productos" 
                                       FontSize="12" Style="{StaticResource HeaderTextStyle}" 
                                       Margin="0,0,30,0" Opacity="0.9"/>

                            <TextBlock Grid.Column="2" x:Name="TxtFechaHora" 
                                       Text="{Binding Source={x:Static sys:DateTime.Now}, StringFormat='dd/MM/yyyy HH:mm'}" 
                                       FontSize="12" Style="{StaticResource HeaderTextStyle}" Opacity="0.9"/>
                        </Grid>
                    </Border>

                    <!-- Toolbar -->
                    <Border Grid.Row="1" Background="#FFFFFF" BorderBrush="#E2E8F0" BorderThickness="0,0,0,1">
                        <Grid Margin="15,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Botones de acción -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <Button x:Name="BtnAgregar" Content="➕ Nuevo" Width="75"
                                        Background="#10B981" Foreground="White" 
                                        Style="{StaticResource CompactButtonStyle}" 
                                        Click="BtnAgregar_Click"/>

                                <Button x:Name="BtnEditar" Content="✏️ Editar" Width="70"
                                        Background="#3B82F6" Foreground="White"
                                        Style="{StaticResource CompactButtonStyle}"
                                        Click="BtnEditar_Click"/>

                                <Button x:Name="BtnEliminar" Content="🗑️ Borrar" Width="70"
                                        Background="#EF4444" Foreground="White"
                                        Style="{StaticResource CompactButtonStyle}"
                                        Click="BtnEliminar_Click"/>

                                <Button x:Name="BtnEscaner" Content="📱 Escáner" Width="80"
                                        Background="#8B5CF6" Foreground="White"
                                        Style="{StaticResource CompactButtonStyle}"
                                        Click="BtnEscaner_Click"/>
                            </StackPanel>

                            <!-- Búsqueda -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBox x:Name="TxtBuscar" 
                                         Width="350" Height="28" Padding="8,5"
                                         FontSize="13" VerticalContentAlignment="Center"
                                         BorderBrush="#CBD5E1" BorderThickness="1"
                                         Background="White"
                                         TextChanged="TxtBuscar_TextChanged"/>
                                <Button x:Name="BtnBuscar" Content="🔍" 
                                        Width="28" Height="28" Margin="2,0,0,0"
                                        Background="#64748B" Foreground="White" FontSize="11"
                                        BorderThickness="0" Click="BtnBuscar_Click"/>
                            </StackPanel>

                            <!-- Totales compactos -->
                            <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="20,0,10,0">
                                <Border Background="#10B981" CornerRadius="3" Padding="6,2" Margin="0,0,5,0">
                                    <TextBlock x:Name="TxtTotalConIVACompact" Text="c/IVA: $0" 
                                               FontSize="10" FontWeight="Bold" Foreground="White"/>
                                </Border>
                                <Border Background="#3B82F6" CornerRadius="3" Padding="6,2" Margin="0,0,5,0">
                                    <TextBlock x:Name="TxtTotalSinIVACompact" Text="s/IVA: $0" 
                                               FontSize="10" FontWeight="Bold" Foreground="White"/>
                                </Border>
                                <Border Background="#F59E0B" CornerRadius="3" Padding="6,2">
                                    <TextBlock x:Name="TxtDiferenciaIVACompact" Text="Δ: $0" 
                                               FontSize="10" FontWeight="Bold" Foreground="White"/>
                                </Border>
                            </StackPanel>

                            <!-- Actualizar -->
                            <Button Grid.Column="3" x:Name="BtnActualizar" Content="🔄" 
                                    Width="32" Height="28"
                                    Background="#6366F1" Foreground="White" FontSize="12"
                                    BorderThickness="0" Click="BtnActualizar_Click"
                                    ToolTip="Actualizar datos"/>
                        </Grid>
                    </Border>

                    <!-- DataGrid -->
                    <DataGrid x:Name="DgMateriales" Grid.Row="2" 
                              AutoGenerateColumns="False" 
                              CanUserAddRows="False" 
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              SelectionMode="Single"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              AlternatingRowBackground="#F8FAFC"
                              RowBackground="White"
                              BorderThickness="0"
                              FontSize="11"
                              RowHeight="28"
                              ColumnHeaderHeight="35"
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Auto">

                        <DataGrid.ColumnHeaderStyle>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Background" Value="#F1F5F9"/>
                                <Setter Property="Foreground" Value="#374151"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter Property="FontSize" Value="11"/>
                                <Setter Property="Padding" Value="8,5"/>
                                <Setter Property="BorderBrush" Value="#E2E8F0"/>
                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                            </Style>
                        </DataGrid.ColumnHeaderStyle>

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="📝 Nombre" Binding="{Binding NombreArticulo}" 
                                                Width="180" FontWeight="SemiBold">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="🏷️ Categoría" Binding="{Binding Categoria}" Width="100">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#6B7280"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="📏 Unidad" Binding="{Binding UnidadMedida}" Width="70">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#6B7280"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="📦 Stock" Binding="{Binding StockTotal, StringFormat=F2, Mode=OneWay}" Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#374151"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="💵 P/Unid" Binding="{Binding PrecioPorUnidad, StringFormat=C2, Mode=OneWay}" Width="85">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#6B7280"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="💚 c/IVA" Binding="{Binding PrecioConIVA, StringFormat=C2}" Width="85">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#10B981"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="💙 s/IVA" Binding="{Binding PrecioSinIVA, StringFormat=C2}" Width="85">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#3B82F6"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="💰 Total c/IVA" Binding="{Binding ValorTotalConIVA, StringFormat=C2, Mode=OneWay}" Width="110">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#10B981"/>
                                        <Setter Property="Background" Value="#ECFDF5"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="💰 Total s/IVA" Binding="{Binding ValorTotalSinIVA, StringFormat=C2, Mode=OneWay}" Width="110">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#3B82F6"/>
                                        <Setter Property="Background" Value="#EFF6FF"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="📊 %IVA" Binding="{Binding PorcentajeIVA, StringFormat=F1, Mode=OneWay}" Width="60">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#F59E0B"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="🔢 Código" Binding="{Binding CodigoBarras}" Width="100" FontFamily="JetBrains Mono, Consolas">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#6B7280"/>
                                        <Setter Property="FontSize" Value="10"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="🏪 Proveedor" Binding="{Binding Proveedor}" Width="120">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Padding" Value="8,0"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#6B7280"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTemplateColumn Header="🚨" Width="50">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Ellipse Width="16" Height="16" HorizontalAlignment="Center">
                                            <Ellipse.Style>
                                                <Style TargetType="Ellipse">
                                                    <Setter Property="Fill" Value="#10B981"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding TieneStockBajo, Mode=OneWay}" Value="True">
                                                            <Setter Property="Fill" Value="#EF4444"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Ellipse.Style>
                                        </Ellipse>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Status Bar -->
                    <Border Grid.Row="3" Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="0,1,0,0">
                        <Grid Margin="15,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock x:Name="TxtStatus" Grid.Column="0" 
                                       Text="✅ Sistema listo" FontSize="11" 
                                       VerticalAlignment="Center" Foreground="#6B7280"/>

                            <TextBlock x:Name="TxtTotalConIVA" Grid.Column="1" 
                                       Text="Total con IVA: $0.00" FontSize="11" FontWeight="Bold" 
                                       Foreground="#10B981" VerticalAlignment="Center" Margin="15,0"/>

                            <TextBlock x:Name="TxtTotalSinIVA" Grid.Column="2" 
                                       Text="Total sin IVA: $0.00" FontSize="11" FontWeight="Bold" 
                                       Foreground="#3B82F6" VerticalAlignment="Center" Margin="15,0"/>

                            <TextBlock x:Name="TxtDiferenciaIVA" Grid.Column="3" 
                                       Text="Diferencia IVA: $0.00" FontSize="11" FontWeight="Bold" 
                                       Foreground="#F59E0B" VerticalAlignment="Center" Margin="15,0"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ========== PESTAÑA POS ACTUALIZADA ========== -->
            <TabItem Header="💰 Punto de Venta" Style="{StaticResource TabItemStyle}">
                <Grid Background="#F8FAFC">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="50"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="35"/>
                    </Grid.RowDefinitions>

                    <!-- Header POS -->
                    <Border Grid.Row="0" Background="#059669" Padding="20,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="💰 Sistema Punto de Venta" 
                                       FontSize="18" Style="{StaticResource HeaderTextStyle}"/>

                            <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,30,0">
                                <TextBlock x:Name="TxtVentasHoy" Text="Ventas hoy: 0" 
                                           FontSize="12" Style="{StaticResource HeaderTextStyle}" 
                                           Margin="0,0,15,0" Opacity="0.9"/>
                                <TextBlock x:Name="TxtTotalVentasHoy" Text="Total: $0.00" 
                                           FontSize="12" Style="{StaticResource HeaderTextStyle}" 
                                           Opacity="0.9"/>
                            </StackPanel>

                            <TextBlock Grid.Column="2" x:Name="TxtFechaHoraPOS" 
                                       Text="{Binding Source={x:Static sys:DateTime.Now}, StringFormat='dd/MM/yyyy HH:mm'}" 
                                       FontSize="12" Style="{StaticResource HeaderTextStyle}" Opacity="0.9"/>
                        </Grid>
                    </Border>

                    <!-- Toolbar POS - SIN BOTÓN DE ANÁLISIS -->
                    <Border Grid.Row="1" Background="#FFFFFF" BorderBrush="#E2E8F0" BorderThickness="0,0,0,1">
                        <Grid Margin="15,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- ===== DISPOSITIVOS POS ACTUALIZADOS ===== -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <Button x:Name="BtnEscanerPOS" Content="📱 Escáner" Width="90"
                                        Background="#8B5CF6" Foreground="White" 
                                        Style="{StaticResource POSButtonStyle}" 
                                        Click="BtnEscanerPOS_Click" Height="32"/>

                                <Button x:Name="BtnBascula" Content="⚖️ Báscula" Width="90"
                                        Background="#F59E0B" Foreground="White"
                                        Style="{StaticResource POSButtonStyle}"
                                        Click="BtnBascula_Click" Height="32"/>

                                <Button x:Name="BtnImpresora" Content="🖨️ Impresora" Width="90"
                                        Background="#6366F1" Foreground="White"
                                        Style="{StaticResource POSButtonStyle}"
                                        Click="BtnImpresora_Click" Height="32"/>

                                <Button x:Name="BtnConfigurarPrecios" Content="💰 Precios" Width="90"
                                        Background="#10B981" Foreground="White"
                                        Style="{StaticResource POSButtonStyle}"
                                        Click="BtnConfigurarPrecios_Click" Height="32"/>

                                <!-- ===== SOLO BOTÓN DE COMISIONES (SIN ANÁLISIS) ===== -->
                                <Button x:Name="BtnConfigComisiones" Content="🏦 Comisiones" Width="100"
                                        Background="#EF4444" Foreground="White"
                                        Style="{StaticResource POSButtonStyle}"
                                        Click="BtnConfigComisiones_Click" Height="32"/>
                            </StackPanel>

                            <!-- Búsqueda productos POS -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBox x:Name="TxtBuscarPOS" 
                                         Width="300" Height="32" Padding="10,8"
                                         FontSize="13" VerticalContentAlignment="Center"
                                         BorderBrush="#CBD5E1" BorderThickness="1"
                                         Background="White" Margin="0,0,5,0"
                                         TextChanged="TxtBuscarPOS_TextChanged"
                                         KeyDown="TxtBuscarPOS_KeyDown"/>
                                <Button x:Name="BtnBuscarPOS" Content="🔍" 
                                        Width="32" Height="32"
                                        Background="#64748B" Foreground="White" FontSize="11"
                                        BorderThickness="0" Click="BtnBuscarPOS_Click"/>
                            </StackPanel>

                            <!-- Estado dispositivos -->
                            <StackPanel Grid.Column="2" Orientation="Horizontal">
                                <Border Background="#10B981" CornerRadius="3" Padding="5,2" Margin="0,0,3,0">
                                    <TextBlock x:Name="TxtEstadoEscaner" Text="📱 OK" 
                                               FontSize="10" FontWeight="Bold" Foreground="White"/>
                                </Border>
                                <Border Background="#10B981" CornerRadius="3" Padding="5,2" Margin="0,0,3,0">
                                    <TextBlock x:Name="TxtEstadoBascula" Text="⚖️ OK" 
                                               FontSize="10" FontWeight="Bold" Foreground="White"/>
                                </Border>
                                <Border Background="#10B981" CornerRadius="3" Padding="5,2">
                                    <TextBlock x:Name="TxtEstadoImpresora" Text="🖨️ OK" 
                                               FontSize="10" FontWeight="Bold" Foreground="White"/>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Contenido principal POS -->
                    <Grid Grid.Row="2" Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="10"/>
                            <ColumnDefinition Width="1.5*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Panel izquierdo: Productos -->
                        <Border Grid.Column="0" Background="White" CornerRadius="10" 
                                BorderBrush="#E5E7EB" BorderThickness="1">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Header productos -->
                                <Border Grid.Row="0" Background="#F9FAFB" CornerRadius="10,10,0,0" 
                                        BorderBrush="#E5E7EB" BorderThickness="0,0,0,1" Padding="15,10">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0" Text="🛍️ Productos Disponibles" 
                                                   FontSize="16" FontWeight="Bold" Foreground="#374151"/>
                                        <TextBlock Grid.Column="1" x:Name="TxtCountProductos" Text="0 productos" 
                                                   FontSize="12" Foreground="#6B7280" VerticalAlignment="Center"/>
                                    </Grid>
                                </Border>

                                <!-- Lista productos -->
                                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="10">
                                    <ListBox x:Name="LstProductosPOS" 
                                             BorderThickness="0" 
                                             Background="Transparent"
                                             ItemContainerStyle="{StaticResource ProductoListBoxItemStyle}"
                                             SelectionChanged="LstProductosPOS_SelectionChanged"
                                             MouseDoubleClick="LstProductosPOS_MouseDoubleClick"/>
                                </ScrollViewer>
                            </Grid>
                        </Border>

                        <!-- Panel derecho: Carrito -->
                        <Border Grid.Column="2" Background="White" CornerRadius="10" 
                                BorderBrush="#E5E7EB" BorderThickness="1">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Header carrito -->
                                <Border Grid.Row="0" Background="#F9FAFB" CornerRadius="10,10,0,0" 
                                        BorderBrush="#E5E7EB" BorderThickness="0,0,0,1" Padding="15,10">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0" Text="🛒 Carrito de Compras" 
                                                   FontSize="16" FontWeight="Bold" Foreground="#374151"/>
                                        <TextBlock Grid.Column="1" x:Name="TxtCountCarrito" Text="0 artículos" 
                                                   FontSize="12" Foreground="#6B7280" VerticalAlignment="Center"/>
                                    </Grid>
                                </Border>

                                <!-- Items del carrito -->
                                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="10">
                                    <ListBox x:Name="LstCarrito" 
                                             BorderThickness="0" 
                                             Background="Transparent">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="White" Margin="2" CornerRadius="5"
                                                        BorderThickness="1" BorderBrush="#E5E7EB" Padding="10">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>

                                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding NombreProducto}" 
                                                                   FontWeight="Bold" FontSize="12" Foreground="#111827"/>
                                                        <Button Grid.Row="0" Grid.Column="1" Content="❌" 
                                                                Background="Transparent" BorderThickness="0" 
                                                                Foreground="#EF4444" FontSize="10" Width="20" Height="20"
                                                                Click="BtnEliminarDelCarrito_Click" Tag="{Binding}"/>

                                                        <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,5,0,0">
                                                            <TextBlock Text="Cant: " FontSize="10" Foreground="#6B7280"/>
                                                            <TextBlock Text="{Binding Cantidad, StringFormat=F2}" FontSize="10" Foreground="#6B7280"/>
                                                            <TextBlock Text=" × " FontSize="10" Foreground="#6B7280" Margin="5,0"/>
                                                            <TextBlock Text="{Binding PrecioUnitario, StringFormat=C2}" FontSize="10" Foreground="#6B7280"/>
                                                        </StackPanel>

                                                        <TextBlock Grid.Row="2" Grid.ColumnSpan="2" Text="{Binding SubTotal, StringFormat=C2}" 
                                                                   FontWeight="Bold" FontSize="13" Foreground="#059669" Margin="0,5,0,0"/>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </ScrollViewer>

                                <!-- Panel totales -->
                                <Border Grid.Row="2" Background="#F9FAFB" BorderBrush="#E5E7EB" 
                                        BorderThickness="0,1,0,1" Padding="15">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Subtotal:" FontSize="12" Foreground="#6B7280"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="TxtSubTotal" Text="$0.00" 
                                                   FontSize="12" FontWeight="Bold" Foreground="#374151"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Descuento:" FontSize="12" Foreground="#6B7280" Margin="0,3,0,0"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="TxtDescuento" Text="$0.00" 
                                                   FontSize="12" FontWeight="Bold" Foreground="#EF4444" Margin="0,3,0,0"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="IVA:" FontSize="12" Foreground="#6B7280" Margin="0,3,0,0"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" x:Name="TxtIVA" Text="$0.00" 
                                                   FontSize="12" FontWeight="Bold" Foreground="#F59E0B" Margin="0,3,0,0"/>

                                        <Separator Grid.Row="3" Grid.ColumnSpan="2" Margin="0,8"/>

                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="TOTAL:" FontSize="16" FontWeight="Bold" Foreground="#059669"/>
                                        <TextBlock Grid.Row="4" Grid.Column="1" x:Name="TxtTotal" Text="$0.00" 
                                                   FontSize="18" FontWeight="Bold" Foreground="#059669"/>
                                    </Grid>
                                </Border>

                                <!-- Botones de acción -->
                                <Grid Grid.Row="3" Margin="15">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Cliente -->
                                    <Grid Grid.Row="0" Margin="0,0,0,15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0" Text="Cliente:" VerticalAlignment="Center" 
                                                   FontSize="12" Foreground="#374151" Margin="0,0,10,0"/>
                                        <TextBox Grid.Column="1" x:Name="TxtCliente" Height="30" FontSize="12" 
                                                 Text="Cliente General" Padding="8,5"/>
                                    </Grid>

                                    <!-- Botones principales -->
                                    <Grid Grid.Row="1">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <Button Grid.Row="0" x:Name="BtnProcesarVenta" Content="💰 PROCESAR VENTA" 
                                                Height="45" FontSize="16" FontWeight="Bold"
                                                Background="#059669" Foreground="White" Margin="0,0,0,8"
                                                Style="{StaticResource POSButtonStyle}"
                                                Click="BtnProcesarVenta_Click"/>

                                        <Grid Grid.Row="1">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <Button Grid.Column="0" x:Name="BtnLimpiarCarrito" Content="🗑️ Limpiar" 
                                                    Height="35" FontSize="12" FontWeight="Bold" Margin="0,0,4,0"
                                                    Background="#EF4444" Foreground="White"
                                                    Style="{StaticResource POSButtonStyle}"
                                                    Click="BtnLimpiarCarrito_Click"/>

                                            <Button Grid.Column="1" x:Name="BtnVerVentas" Content="📊 Ventas" 
                                                    Height="35" FontSize="12" FontWeight="Bold" Margin="4,0,0,0"
                                                    Background="#6366F1" Foreground="White"
                                                    Style="{StaticResource POSButtonStyle}"
                                                    Click="BtnVerVentas_Click"/>
                                        </Grid>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Status Bar POS -->
                    <Border Grid.Row="3" Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="0,1,0,0">
                        <Grid Margin="15,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock x:Name="TxtStatusPOS" Grid.Column="0" 
                                       Text="✅ Sistema POS listo" FontSize="11" 
                                       VerticalAlignment="Center" Foreground="#6B7280"/>

                            <TextBlock x:Name="TxtProductosDisponibles" Grid.Column="1" 
                                       Text="Productos: 0" FontSize="11" FontWeight="Bold" 
                                       Foreground="#059669" VerticalAlignment="Center" Margin="15,0"/>

                            <TextBlock x:Name="TxtGananciaPrevista" Grid.Column="2" 
                                       Text="Ganancia: $0.00" FontSize="11" FontWeight="Bold" 
                                       Foreground="#F59E0B" VerticalAlignment="Center" Margin="15,0"/>

                            <TextBlock x:Name="TxtMargenPromedio" Grid.Column="3" 
                                       Text="Margen: 0%" FontSize="11" FontWeight="Bold" 
                                       Foreground="#3B82F6" VerticalAlignment="Center" Margin="15,0"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Pestaña 2: Reportes -->
            <TabItem Header="📊 Reportes" Style="{StaticResource TabItemStyle}">
                <Grid Background="White">
                    <Border Margin="50" Background="#F8FAFC" CornerRadius="10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="📊" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                            <TextBlock Text="Módulo de Reportes" FontSize="24" FontWeight="Bold" 
                                      HorizontalAlignment="Center" Foreground="#374151" Margin="0,0,0,10"/>
                            <TextBlock Text="Genere reportes detallados de inventario, movimientos y análisis financiero" 
                                      FontSize="14" HorizontalAlignment="Center" Foreground="#6B7280" Margin="0,0,0,30"/>
                            <Button Content="🚀 Abrir Reportes" Width="200" Height="40" 
                                   Background="#10B981" Foreground="White" FontSize="14" FontWeight="Bold"
                                   BorderThickness="0" Click="BtnAbrirReportes_Click"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Pestaña 3: Procesos -->
            <TabItem Header="⚙️ Procesos" Style="{StaticResource TabItemStyle}">
                <Grid Background="White">
                    <Border Margin="50" Background="#F8FAFC" CornerRadius="10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="⚙️" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                            <TextBlock Text="Gestión de Procesos" FontSize="24" FontWeight="Bold" 
                                      HorizontalAlignment="Center" Foreground="#374151" Margin="0,0,0,10"/>
                            <TextBlock Text="Configure y monitoree procesos de producción y transformación" 
                                      FontSize="14" HorizontalAlignment="Center" Foreground="#6B7280" Margin="0,0,0,30"/>
                            <Button Content="🔧 Configurar Procesos" Width="200" Height="40" 
                                   Background="#3B82F6" Foreground="White" FontSize="14" FontWeight="Bold"
                                   BorderThickness="0" Click="BtnConfigurarProcesos_Click"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Pestaña 4: Análisis -->
            <TabItem Header="📈 Análisis" Style="{StaticResource TabItemStyle}">
                <Grid Background="White">
                    <Border Margin="50" Background="#F8FAFC" CornerRadius="10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="📈" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                            <TextBlock Text="Dashboard de Análisis" FontSize="24" FontWeight="Bold" 
                                      HorizontalAlignment="Center" Foreground="#374151" Margin="0,0,0,10"/>
                            <TextBlock Text="Visualice tendencias, métricas y análisis avanzados de su inventario" 
                                      FontSize="14" HorizontalAlignment="Center" Foreground="#6B7280" Margin="0,0,0,30"/>
                            <Button Content="📊 Ver Dashboard" Width="200" Height="40" 
                                   Background="#8B5CF6" Foreground="White" FontSize="14" FontWeight="Bold"
                                   BorderThickness="0" Click="BtnVerDashboard_Click"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Pestaña 5: Configuración -->
            <TabItem Header="⚙️ Configuración" Style="{StaticResource TabItemStyle}">
                <Grid Background="White">
                    <Border Margin="50" Background="#F8FAFC" CornerRadius="10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="⚙️" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                            <TextBlock Text="Configuración del Sistema" FontSize="24" FontWeight="Bold" 
                                      HorizontalAlignment="Center" Foreground="#374151" Margin="0,0,0,10"/>
                            <TextBlock Text="Configure parámetros del sistema, usuarios y preferencias" 
                                      FontSize="14" HorizontalAlignment="Center" Foreground="#6B7280" Margin="0,0,0,30"/>
                            <Button Content="🔧 Abrir Configuración" Width="200" Height="40" 
                                   Background="#F59E0B" Foreground="White" FontSize="14" FontWeight="Bold"
                                   BorderThickness="0" Click="BtnAbrirConfiguracion_Click"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Pestaña 6: Mi Información -->
            <TabItem Header="👨‍💻 Mi Información" Style="{StaticResource TabItemStyle}">
                <Grid Background="White">
                    <Border Margin="50" Background="#F8FAFC" CornerRadius="10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="👨‍💻" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                            <TextBlock Text="Información del Desarrollador" FontSize="24" FontWeight="Bold" 
                                      HorizontalAlignment="Center" Foreground="#374151" Margin="0,0,0,10"/>
                            <TextBlock Text="Conoce más sobre el creador de este sistema y los detalles del proyecto" 
                                      FontSize="14" HorizontalAlignment="Center" Foreground="#6B7280" Margin="0,0,0,30"/>
                            <Button Content="ℹ️ Ver Información Completa" Width="250" Height="40" 
                                   Background="#6366F1" Foreground="White" FontSize="14" FontWeight="Bold"
                                   BorderThickness="0" Click="BtnAbrirInformacion_Click"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

        </TabControl>
    </Grid>
</Window>