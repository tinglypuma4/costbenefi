<Window x:Class="costbenefi.Views.VentanaGraficoAmpliadoRentabilidad"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Vista Ampliada - Gráficos de Rentabilidad" 
        Height="700" Width="1200" 
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        MinHeight="600" MinWidth="900">

    <Window.Resources>
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="35"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{TemplateBinding BorderBrush}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.95" ScaleY="0.95"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Background="#F9FAFB">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- HEADER PRINCIPAL -->
        <Border Grid.Row="0" Background="#10B981" Padding="30,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="💰" FontSize="28" Foreground="White" VerticalAlignment="Center" Margin="0,0,15,0"/>
                        <StackPanel>
                            <TextBlock x:Name="TxtTituloVentana" Text="Vista Ampliada - Análisis de Rentabilidad" 
                                       FontSize="22" FontWeight="Bold" Foreground="White"/>
                            <TextBlock x:Name="TxtSubtituloVentana" Text="Gráfico interactivo de alta resolución con análisis detallado de márgenes y ROI" 
                                       FontSize="14" Foreground="White" Opacity="0.9"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal">
                        <Border Background="#FFFFFF" CornerRadius="6" Padding="10,5" Opacity="0.9" Margin="0,0,10,0">
                            <TextBlock x:Name="TxtItemsInfo" Text="📊 Items analizados: --" FontSize="11" FontWeight="Bold" Foreground="#374151"/>
                        </Border>
                        <Border Background="#FFFFFF" CornerRadius="6" Padding="10,5" Opacity="0.9" Margin="0,0,10,0">
                            <TextBlock x:Name="TxtTipoAnalisis" Text="🎯 Análisis: Productos" FontSize="11" FontWeight="Bold" Foreground="#374151"/>
                        </Border>
                        <Border Background="#FFFFFF" CornerRadius="6" Padding="10,5" Opacity="0.9">
                            <TextBlock x:Name="TxtMetricaAnalisis" Text="💰 Métrica: Margen Bruto" FontSize="11" FontWeight="Bold" Foreground="#374151"/>
                        </Border>
                    </StackPanel>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button x:Name="BtnExportarGrafico" Content="📸 Exportar Imagen" Width="140" Height="40"
                            Background="#FFFFFF" Foreground="#10B981" FontSize="12"
                            Style="{StaticResource ModernButtonStyle}"
                            Click="BtnExportarGrafico_Click"/>
                    
                    <Button x:Name="BtnCerrarVentana" Content="✖️ Cerrar" Width="100" Height="40"
                            Background="#EF4444" Foreground="White" FontSize="12"
                            Style="{StaticResource ModernButtonStyle}"
                            Click="BtnCerrarVentana_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- TOOLBAR DE CONTROLES -->
        <Border Grid.Row="1" Background="White" BorderBrush="#E5E7EB" BorderThickness="0,0,0,1" Padding="30,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="📊 Tipo de Gráfico:" VerticalAlignment="Center" FontWeight="Bold" 
                               FontSize="13" Foreground="#374151" Margin="0,0,10,0"/>
                    
                    <ComboBox x:Name="CmbTipoGrafico" Width="180" Height="35" 
                              VerticalContentAlignment="Center" Margin="0,0,20,0" FontSize="12"
                              SelectionChanged="CmbTipoGrafico_SelectionChanged">
                        <ComboBoxItem Content="📊 Barras de Rentabilidad" IsSelected="True" Tag="barras"/>
                        <ComboBoxItem Content="📈 Línea de Rentabilidad" Tag="linea"/>
                        <ComboBoxItem Content="💰 Costo vs Beneficio" Tag="costo_beneficio"/>
                        <ComboBoxItem Content="🍰 Gráfico Circular" Tag="circular"/>
                    </ComboBox>

                    <TextBlock Text="🎨 Tema:" VerticalAlignment="Center" FontWeight="Bold" 
                               FontSize="13" Foreground="#374151" Margin="0,0,10,0"/>
                    
                    <ComboBox x:Name="CmbTemaGrafico" Width="120" Height="35" 
                              VerticalContentAlignment="Center" FontSize="12"
                              SelectionChanged="CmbTemaGrafico_SelectionChanged">
                        <ComboBoxItem Content="🎨 Estándar" IsSelected="True" Tag="estandar"/>
                        <ComboBoxItem Content="🌙 Oscuro" Tag="oscuro"/>
                        <ComboBoxItem Content="🌈 Vibrante" Tag="vibrante"/>
                        <ComboBoxItem Content="📰 Minimalista" Tag="minimal"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                    <TextBlock Text="📏 Resolución:" VerticalAlignment="Center" FontSize="12" Foreground="#6B7280" Margin="0,0,8,0"/>
                    <ComboBox x:Name="CmbResolucion" Width="120" Height="30" FontSize="11"
                              SelectionChanged="CmbResolucion_SelectionChanged">
                        <ComboBoxItem Content="HD (1280x720)" Tag="hd"/>
                        <ComboBoxItem Content="Full HD (1920x1080)" IsSelected="True" Tag="fhd"/>
                        <ComboBoxItem Content="4K (3840x2160)" Tag="4k"/>
                    </ComboBox>
                    
                    <CheckBox x:Name="ChkMostrarEtiquetas" Content="🏷️ Etiquetas" IsChecked="True" 
                              VerticalAlignment="Center" Margin="20,0,0,0" FontSize="11"/>
                    <CheckBox x:Name="ChkMostrarLineasReferencia" Content="📊 Líneas Objetivo" IsChecked="True" 
                              VerticalAlignment="Center" Margin="15,0,0,0" FontSize="11"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button x:Name="BtnActualizar" Content="🔄 Actualizar" Width="110" Height="35"
                            Background="#059669" Foreground="White" FontSize="12"
                            Style="{StaticResource ModernButtonStyle}"
                            Click="BtnActualizar_Click"/>

                    <Button x:Name="BtnPantallaCompleta" Content="🖥️ Pantalla Completa" Width="150" Height="35"
                            Background="#3B82F6" Foreground="White" FontSize="12"
                            Style="{StaticResource ModernButtonStyle}"
                            Click="BtnPantallaCompleta_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ÁREA PRINCIPAL DEL GRÁFICO -->
        <Border Grid.Row="2" Background="White" Margin="30,20,30,15" CornerRadius="12" 
                BorderBrush="#E5E7EB" BorderThickness="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header del gráfico -->
                <Border Grid.Row="0" Background="#F8FAFC" CornerRadius="12,12,0,0" Padding="25,15">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0">
                            <TextBlock x:Name="TxtTituloGrafico" Text="Análisis de Rentabilidad - Productos por Margen Bruto" 
                                       FontSize="18" FontWeight="Bold" Foreground="#374151"/>
                            <TextBlock x:Name="TxtDescripcionGrafico" Text="Gráfico interactivo mostrando análisis detallado de rentabilidad, márgenes y ROI" 
                                       FontSize="12" Foreground="#6B7280" Margin="0,3,0,0"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <TextBlock x:Name="TxtRentabilidadInfo" Text="📊 Distribución: --A/--M/--B" 
                                       FontSize="12" FontWeight="Bold" Foreground="#10B981" 
                                       VerticalAlignment="Center" Margin="0,0,15,0"/>
                            <TextBlock x:Name="TxtMargenPromedio" Text="📈 Margen Promedio: --%"
                                       FontSize="12" FontWeight="Bold" Foreground="#059669" 
                                       VerticalAlignment="Center" Margin="0,0,15,0"/>
                            <Button x:Name="BtnConfigGrafico" Content="⚙️" Width="40" Height="40"
                                    Background="#6B7280" Foreground="White" FontSize="16"
                                    Style="{StaticResource ModernButtonStyle}"
                                    Click="BtnConfigGrafico_Click"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Área del gráfico con scroll -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" 
                              Background="#FAFAFA" Padding="20">
                    <Canvas x:Name="CanvasGraficoAmpliado" Background="White" 
                            MinWidth="1000" MinHeight="500" 
                            ClipToBounds="False"/>
                </ScrollViewer>

                <!-- Footer con leyenda y métricas -->
                <Border Grid.Row="2" Background="#F8FAFC" CornerRadius="0,0,12,12" Padding="25,15">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Leyenda del gráfico -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <Border Background="#10B981" Width="20" Height="15" CornerRadius="3" Margin="0,0,8,0"/>
                            <TextBlock Text="Alta Rentabilidad (&gt;=25%)" FontSize="11" FontWeight="Bold" Foreground="#374151" VerticalAlignment="Center" Margin="0,0,25,0"/>
                            
                            <Border Background="#F59E0B" Width="20" Height="15" CornerRadius="3" Margin="0,0,8,0"/>
                            <TextBlock Text="Media Rentabilidad (15-25%)" FontSize="11" FontWeight="Bold" Foreground="#374151" VerticalAlignment="Center" Margin="0,0,25,0"/>
                            
                            <Border Background="#EF4444" Width="20" Height="15" CornerRadius="3" Margin="0,0,8,0"/>
                            <TextBlock Text="Baja Rentabilidad (&lt;15%)" FontSize="11" FontWeight="Bold" Foreground="#374151" VerticalAlignment="Center" Margin="0,0,25,0"/>
                            
                            <Line Stroke="#10B981" StrokeThickness="3" StrokeDashArray="5,5" X1="0" Y1="7" X2="25" Y2="7" Margin="0,0,8,0"/>
                            <TextBlock Text="Objetivo 25%" FontSize="11" FontWeight="Bold" Foreground="#10B981" VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Métricas adicionales -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <TextBlock x:Name="TxtTotalItems" Text="Total: -- items" FontSize="11" FontWeight="Bold" 
                                       Foreground="#6B7280" VerticalAlignment="Center" Margin="0,0,20,0"/>
                            <TextBlock x:Name="TxtValorTotal" Text="Ganancia Total: $--" FontSize="11" FontWeight="Bold" 
                                       Foreground="#10B981" VerticalAlignment="Center" Margin="0,0,20,0"/>
                            <TextBlock x:Name="TxtUltimaActualizacion" Text="Actualizado: --" FontSize="10" 
                                       Foreground="#6B7280" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- STATUS BAR -->
        <Border Grid.Row="3" Background="#F8FAFC" BorderBrush="#E5E7EB" BorderThickness="0,1,0,0" Padding="30,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="TxtStatusVentana" Grid.Column="0" 
                           Text="💰 Vista ampliada - Gráfico de rentabilidad de alta resolución cargado" 
                           FontSize="11" VerticalAlignment="Center" Foreground="#6B7280"/>

                <TextBlock x:Name="TxtResolucionActual" Grid.Column="1" 
                           Text="Resolución: 1920x1080" FontSize="11" FontWeight="Bold" 
                           Foreground="#3B82F6" VerticalAlignment="Center" Margin="20,0"/>

                <TextBlock x:Name="TxtTiempoRenderizado" Grid.Column="2" 
                           Text="Renderizado: --ms" FontSize="11" FontWeight="Bold" 
                           Foreground="#8B5CF6" VerticalAlignment="Center" Margin="20,0"/>
            </Grid>
        </Border>
    </Grid>
</Window>